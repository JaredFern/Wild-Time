/var/spool/slurmd/job614026/slurm_script: line 18: activate: No such file or directory
2023-05-05 12:35:24,855 - root - INFO - Namespace(K=1, buffer_size=100, checkpoint_path=None, config_file=None, contour_granularity=5, contour_increment=0.01, contour_margin=0.1, contour_metric='losses', contour_models=None, contour_timesteps=None, coral_lambda=1.0, cut_mix=False, data_dir='/projects/tir6/strubell/data/wilds/data', dataset='fmow', device=0, difficulty=False, emp_FI=False, epsilon=0.001, eval=False, eval_all_timestamps=False, eval_batch_size=512, eval_fix=False, eval_fixed_timesteps=[], eval_next_timestamps=6, eval_stream=False, eval_warmstart_finetune=True, ewc_lambda=1.0, ewc_task_decay=1.0, exp_name='0505_fmow_swa_csaw_lambda0.90_seed_1', exp_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_lambda0.90_seed_1', feat_num_components=50, feat_num_samples=100, feat_split='test', feat_threshold=0.1, fisher_n=None, gamma=1.0, group_size=3, irm_lambda=1.0, irm_penalty_anneal_iters=0, last_k_timesteps=1, linear_probe=False, linear_probe_iter=None, lisa=False, lisa_intra_domain=False, lisa_start_time=0, load_model=False, log_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', loss_contours=False, lr=0.0001, method='swa', mini_batch_size=64, mix_alpha=2.0, mixup=False, model_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_lambda0.90_seed_1/checkpoints', momentum=0.9, non_overlapping=False, num_groups=3, num_workers=8, offline_steps=3000, online=False, online_steps=500, online_timesteps=[], prediction_type=None, random_seed=1, reduced_train_prop=None, reduction='mean', regression=False, results_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', sam=False, shuffle_timesteps=False, si_c=0.1, split_time=10, ssl_finetune_iter=0, swa_ewa=True, swa_ewa_lambda=0.9, swa_steps=None, time_conditioned=False, torch_compile=False, train=True, train_update_iter=3000, weight_decay=0.0)
2023-05-05 12:35:29,618 - root - INFO - Namespace(K=1, buffer_size=100, checkpoint_path=None, config_file=None, contour_granularity=5, contour_increment=0.01, contour_margin=0.1, contour_metric='losses', contour_models=None, contour_timesteps=None, coral_lambda=1.0, cut_mix=False, data_dir='/projects/tir6/strubell/data/wilds/data', dataset='fmow', device=0, difficulty=False, emp_FI=False, epsilon=0.001, eval=False, eval_all_timestamps=False, eval_batch_size=512, eval_fix=False, eval_fixed_timesteps=[], eval_next_timestamps=6, eval_stream=False, eval_warmstart_finetune=True, ewc_lambda=1.0, ewc_task_decay=1.0, exp_name='0505_fmow_swa_csaw_sam_seed_2', exp_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_2', feat_num_components=50, feat_num_samples=100, feat_split='test', feat_threshold=0.1, fisher_n=None, gamma=1.0, group_size=3, irm_lambda=1.0, irm_penalty_anneal_iters=0, last_k_timesteps=1, linear_probe=False, linear_probe_iter=None, lisa=False, lisa_intra_domain=False, lisa_start_time=0, load_model=False, log_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', loss_contours=False, lr=0.0001, method='swa', mini_batch_size=64, mix_alpha=2.0, mixup=False, model_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_2/checkpoints', momentum=0.9, non_overlapping=False, num_groups=3, num_workers=8, offline_steps=3000, online=False, online_steps=500, online_timesteps=[], prediction_type=None, random_seed=2, reduced_train_prop=None, reduction='mean', regression=False, results_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', sam=True, shuffle_timesteps=False, si_c=0.1, split_time=10, ssl_finetune_iter=0, swa_ewa=True, swa_ewa_lambda=0.5, swa_steps=None, time_conditioned=False, torch_compile=False, train=True, train_update_iter=3000, weight_decay=0.0)
2023-05-05 12:53:07,650 - wildtime.methods.swa.swa - INFO - Training at timestamp 0
2023-05-05 12:55:19,740 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 12:55:20,080 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 0 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_lambda0.90_seed_1/checkpoints/time_0.pth.

2023-05-05 12:55:20,304 - wildtime.methods.swa.swa - INFO - Training at timestamp 1
2023-05-05 12:57:32,900 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 12:57:33,219 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 1 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_lambda0.90_seed_1/checkpoints/time_1.pth.

2023-05-05 12:57:33,436 - wildtime.methods.swa.swa - INFO - Training at timestamp 2
2023-05-05 12:57:50,172 - wildtime.methods.swa.swa - INFO - Training at timestamp 0
2023-05-05 12:59:39,601 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 12:59:39,968 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 2 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_lambda0.90_seed_1/checkpoints/time_2.pth.

2023-05-05 12:59:40,186 - wildtime.methods.swa.swa - INFO - Training at timestamp 3
2023-05-05 13:01:08,449 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:01:08,677 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 0 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_2/checkpoints/time_0.pth.

2023-05-05 13:01:08,889 - wildtime.methods.swa.swa - INFO - Training at timestamp 1
2023-05-05 13:01:47,517 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:01:47,862 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 3 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_lambda0.90_seed_1/checkpoints/time_3.pth.

2023-05-05 13:01:48,099 - wildtime.methods.swa.swa - INFO - Training at timestamp 4
2023-05-05 13:03:59,002 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:03:59,449 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 4 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_lambda0.90_seed_1/checkpoints/time_4.pth.

2023-05-05 13:03:59,680 - wildtime.methods.swa.swa - INFO - Training at timestamp 5
2023-05-05 13:04:27,616 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:04:27,929 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 1 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_2/checkpoints/time_1.pth.

2023-05-05 13:04:28,142 - wildtime.methods.swa.swa - INFO - Training at timestamp 2
2023-05-05 13:06:09,060 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:06:09,430 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 5 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_lambda0.90_seed_1/checkpoints/time_5.pth.

2023-05-05 13:06:09,652 - wildtime.methods.swa.swa - INFO - Training at timestamp 6
2023-05-05 13:07:47,279 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:07:47,591 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 2 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_2/checkpoints/time_2.pth.

2023-05-05 13:07:47,803 - wildtime.methods.swa.swa - INFO - Training at timestamp 3
2023-05-05 13:08:16,691 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:08:17,131 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 6 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_lambda0.90_seed_1/checkpoints/time_6.pth.

2023-05-05 13:08:17,354 - wildtime.methods.swa.swa - INFO - Training at timestamp 7
2023-05-05 13:10:31,085 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:10:31,538 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 7 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_lambda0.90_seed_1/checkpoints/time_7.pth.

2023-05-05 13:10:31,768 - wildtime.methods.swa.swa - INFO - Training at timestamp 8
2023-05-05 13:11:06,340 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:11:06,653 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 3 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_2/checkpoints/time_3.pth.

2023-05-05 13:11:06,863 - wildtime.methods.swa.swa - INFO - Training at timestamp 4
2023-05-05 13:12:47,245 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:12:47,615 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 8 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_lambda0.90_seed_1/checkpoints/time_8.pth.

2023-05-05 13:12:47,881 - wildtime.methods.swa.swa - INFO - Training at timestamp 9
2023-05-05 13:14:24,922 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:14:25,239 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 4 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_2/checkpoints/time_4.pth.

2023-05-05 13:14:25,465 - wildtime.methods.swa.swa - INFO - Training at timestamp 5
2023-05-05 13:15:03,974 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:15:04,328 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 9 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_lambda0.90_seed_1/checkpoints/time_9.pth.

2023-05-05 13:15:04,591 - wildtime.methods.swa.swa - INFO - Training at timestamp 10
2023-05-05 13:17:22,641 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:17:23,045 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 10 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_lambda0.90_seed_1/checkpoints/time_10.pth.

2023-05-05 13:17:23,655 - wildtime.methods.base_trainer - INFO - 
=================================== Results (Eval-Fix) ===================================
2023-05-05 13:17:23,656 - wildtime.methods.base_trainer - INFO - Metric: accuracy

2023-05-05 13:17:44,753 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:17:45,067 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 5 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_2/checkpoints/time_5.pth.

2023-05-05 13:17:45,300 - wildtime.methods.swa.swa - INFO - Training at timestamp 6
2023-05-05 13:19:22,854 - wildtime.methods.base_trainer - INFO - ID accuracy: 	0.5935375651099144

2023-05-05 13:20:10,176 - wildtime.methods.base_trainer - INFO - OOD timestamp = 11: 	 accuracy is 0.6909090909090909
2023-05-05 13:21:04,162 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:21:04,478 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 6 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_2/checkpoints/time_6.pth.

2023-05-05 13:21:04,695 - wildtime.methods.swa.swa - INFO - Training at timestamp 7
2023-05-05 13:21:15,806 - wildtime.methods.base_trainer - INFO - OOD timestamp = 12: 	 accuracy is 0.6781330749354005
2023-05-05 13:22:56,201 - wildtime.methods.base_trainer - INFO - OOD timestamp = 13: 	 accuracy is 0.6205813835713562
2023-05-05 13:24:20,258 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:24:20,575 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 7 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_2/checkpoints/time_7.pth.

2023-05-05 13:24:20,792 - wildtime.methods.swa.swa - INFO - Training at timestamp 8
2023-05-05 13:25:19,033 - wildtime.methods.base_trainer - INFO - OOD timestamp = 14: 	 accuracy is 0.5446456544896296
2023-05-05 13:26:33,868 - wildtime.methods.base_trainer - INFO - OOD timestamp = 15: 	 accuracy is 0.4589364124247845
2023-05-05 13:26:33,882 - wildtime.methods.base_trainer - INFO - 
OOD Average Metric: 	0.5986411232660523
OOD Worst Metric: 	0.4589364124247845
All OOD Metrics: 	[0.6909090909090909, 0.6781330749354005, 0.6205813835713562, 0.5446456544896296, 0.4589364124247845]

2023-05-05 13:26:39,113 - wildtime.methods.base_trainer - INFO - Runtime: 3074.26

2023-05-05 13:27:01,360 - root - INFO - Namespace(K=1, buffer_size=100, checkpoint_path=None, config_file=None, contour_granularity=5, contour_increment=0.01, contour_margin=0.1, contour_metric='losses', contour_models=None, contour_timesteps=None, coral_lambda=1.0, cut_mix=False, data_dir='/projects/tir6/strubell/data/wilds/data', dataset='fmow', device=0, difficulty=False, emp_FI=False, epsilon=0.001, eval=False, eval_all_timestamps=False, eval_batch_size=512, eval_fix=False, eval_fixed_timesteps=[], eval_next_timestamps=6, eval_stream=False, eval_warmstart_finetune=True, ewc_lambda=1.0, ewc_task_decay=1.0, exp_name='0505_fmow_swa_csaw_sam_seed_1', exp_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_1', feat_num_components=50, feat_num_samples=100, feat_split='test', feat_threshold=0.1, fisher_n=None, gamma=1.0, group_size=3, irm_lambda=1.0, irm_penalty_anneal_iters=0, last_k_timesteps=1, linear_probe=False, linear_probe_iter=None, lisa=False, lisa_intra_domain=False, lisa_start_time=0, load_model=False, log_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', loss_contours=False, lr=0.0001, method='swa', mini_batch_size=64, mix_alpha=2.0, mixup=False, model_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_1/checkpoints', momentum=0.9, non_overlapping=False, num_groups=3, num_workers=8, offline_steps=3000, online=False, online_steps=500, online_timesteps=[], prediction_type=None, random_seed=1, reduced_train_prop=None, reduction='mean', regression=False, results_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', sam=True, shuffle_timesteps=False, si_c=0.1, split_time=10, ssl_finetune_iter=0, swa_ewa=True, swa_ewa_lambda=0.5, swa_steps=None, time_conditioned=False, torch_compile=False, train=True, train_update_iter=3000, weight_decay=0.0)
2023-05-05 13:27:36,388 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:27:36,689 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 8 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_2/checkpoints/time_8.pth.

2023-05-05 13:27:36,920 - wildtime.methods.swa.swa - INFO - Training at timestamp 9
2023-05-05 13:30:52,681 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:30:53,139 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 9 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_2/checkpoints/time_9.pth.

2023-05-05 13:30:53,351 - wildtime.methods.swa.swa - INFO - Training at timestamp 10
2023-05-05 13:34:08,682 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:34:08,985 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 10 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_2/checkpoints/time_10.pth.

2023-05-05 13:34:10,065 - wildtime.methods.base_trainer - INFO - 
=================================== Results (Eval-Fix) ===================================
2023-05-05 13:34:10,065 - wildtime.methods.base_trainer - INFO - Metric: accuracy

2023-05-05 13:35:13,912 - wildtime.methods.base_trainer - INFO - ID accuracy: 	0.615343868632471

2023-05-05 13:35:57,112 - wildtime.methods.base_trainer - INFO - OOD timestamp = 11: 	 accuracy is 0.6883116883116883
2023-05-05 13:36:57,685 - wildtime.methods.base_trainer - INFO - OOD timestamp = 12: 	 accuracy is 0.6771640826873385
2023-05-05 13:38:06,896 - wildtime.methods.base_trainer - INFO - OOD timestamp = 13: 	 accuracy is 0.6223032512914007
2023-05-05 13:39:39,583 - wildtime.methods.base_trainer - INFO - OOD timestamp = 14: 	 accuracy is 0.5672034588633373
2023-05-05 13:40:39,822 - wildtime.methods.base_trainer - INFO - OOD timestamp = 15: 	 accuracy is 0.4753618474548707
2023-05-05 13:40:39,838 - wildtime.methods.base_trainer - INFO - 
OOD Average Metric: 	0.606068865721727
OOD Worst Metric: 	0.4753618474548707
All OOD Metrics: 	[0.6883116883116883, 0.6771640826873385, 0.6223032512914007, 0.5672034588633373, 0.4753618474548707]

2023-05-05 13:40:47,753 - wildtime.methods.base_trainer - INFO - Runtime: 3918.13

2023-05-05 13:41:34,359 - root - INFO - Namespace(K=1, buffer_size=100, checkpoint_path=None, config_file=None, contour_granularity=5, contour_increment=0.01, contour_margin=0.1, contour_metric='losses', contour_models=None, contour_timesteps=None, coral_lambda=1.0, cut_mix=False, data_dir='/projects/tir6/strubell/data/wilds/data', dataset='fmow', device=0, difficulty=False, emp_FI=False, epsilon=0.001, eval=False, eval_all_timestamps=False, eval_batch_size=512, eval_fix=False, eval_fixed_timesteps=[], eval_next_timestamps=6, eval_stream=False, eval_warmstart_finetune=True, ewc_lambda=1.0, ewc_task_decay=1.0, exp_name='0505_fmow_swa_csaw_last0.1_seed_2', exp_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.1_seed_2', feat_num_components=50, feat_num_samples=100, feat_split='test', feat_threshold=0.1, fisher_n=None, gamma=1.0, group_size=3, irm_lambda=1.0, irm_penalty_anneal_iters=0, last_k_timesteps=0.1, linear_probe=False, linear_probe_iter=None, lisa=False, lisa_intra_domain=False, lisa_start_time=0, load_model=False, log_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', loss_contours=False, lr=0.0001, method='swa', mini_batch_size=64, mix_alpha=2.0, mixup=False, model_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.1_seed_2/checkpoints', momentum=0.9, non_overlapping=False, num_groups=3, num_workers=8, offline_steps=3000, online=False, online_steps=500, online_timesteps=[], prediction_type=None, random_seed=2, reduced_train_prop=None, reduction='mean', regression=False, results_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', sam=False, shuffle_timesteps=False, si_c=0.1, split_time=10, ssl_finetune_iter=0, swa_ewa=True, swa_ewa_lambda=0.5, swa_steps=None, time_conditioned=False, torch_compile=False, train=True, train_update_iter=3000, weight_decay=0.0)
2023-05-05 13:46:51,781 - wildtime.methods.swa.swa - INFO - Training at timestamp 0
2023-05-05 13:50:08,363 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:50:08,597 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 0 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_1/checkpoints/time_0.pth.

2023-05-05 13:50:08,837 - wildtime.methods.swa.swa - INFO - Training at timestamp 1
2023-05-05 13:53:25,012 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:53:25,319 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 1 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_1/checkpoints/time_1.pth.

2023-05-05 13:53:25,553 - wildtime.methods.swa.swa - INFO - Training at timestamp 2
2023-05-05 13:55:43,980 - wildtime.methods.swa.swa - INFO - Training at timestamp 9
2023-05-05 13:56:41,782 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:56:42,090 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 2 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_1/checkpoints/time_2.pth.

2023-05-05 13:56:42,323 - wildtime.methods.swa.swa - INFO - Training at timestamp 3
2023-05-05 13:58:07,535 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:58:07,939 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 9 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.1_seed_2/checkpoints/time_9.pth.

2023-05-05 13:58:08,212 - wildtime.methods.swa.swa - INFO - Training at timestamp 10
2023-05-05 13:59:59,299 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 13:59:59,610 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 3 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_1/checkpoints/time_3.pth.

2023-05-05 13:59:59,847 - wildtime.methods.swa.swa - INFO - Training at timestamp 4
2023-05-05 14:00:27,155 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:00:27,550 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 10 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.1_seed_2/checkpoints/time_10.pth.

2023-05-05 14:00:28,268 - wildtime.methods.base_trainer - INFO - 
=================================== Results (Eval-Fix) ===================================
2023-05-05 14:00:28,269 - wildtime.methods.base_trainer - INFO - Metric: accuracy

2023-05-05 14:01:31,967 - wildtime.methods.base_trainer - INFO - ID accuracy: 	0.5924781495541627

2023-05-05 14:02:17,890 - wildtime.methods.base_trainer - INFO - OOD timestamp = 11: 	 accuracy is 0.6797402597402598
2023-05-05 14:03:14,219 - wildtime.methods.base_trainer - INFO - OOD timestamp = 12: 	 accuracy is 0.6749031007751938
2023-05-05 14:03:15,659 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:03:15,977 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 4 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_1/checkpoints/time_4.pth.

2023-05-05 14:03:16,207 - wildtime.methods.swa.swa - INFO - Training at timestamp 5
2023-05-05 14:04:24,091 - wildtime.methods.base_trainer - INFO - OOD timestamp = 13: 	 accuracy is 0.6274688544515344
2023-05-05 14:05:57,479 - wildtime.methods.base_trainer - INFO - OOD timestamp = 14: 	 accuracy is 0.5546713453223886
2023-05-05 14:06:34,016 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:06:34,342 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 5 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_1/checkpoints/time_5.pth.

2023-05-05 14:06:34,584 - wildtime.methods.swa.swa - INFO - Training at timestamp 6
2023-05-05 14:06:57,074 - wildtime.methods.base_trainer - INFO - OOD timestamp = 15: 	 accuracy is 0.4649536510001626
2023-05-05 14:06:57,075 - wildtime.methods.base_trainer - INFO - 
OOD Average Metric: 	0.6003474422579078
OOD Worst Metric: 	0.4649536510001626
All OOD Metrics: 	[0.6797402597402598, 0.6749031007751938, 0.6274688544515344, 0.5546713453223886, 0.4649536510001626]

2023-05-05 14:07:07,249 - wildtime.methods.base_trainer - INFO - Runtime: 1532.89

2023-05-05 14:07:28,526 - root - INFO - Namespace(K=1, buffer_size=100, checkpoint_path=None, config_file=None, contour_granularity=5, contour_increment=0.01, contour_margin=0.1, contour_metric='losses', contour_models=None, contour_timesteps=None, coral_lambda=1.0, cut_mix=False, data_dir='/projects/tir6/strubell/data/wilds/data', dataset='fmow', device=0, difficulty=False, emp_FI=False, epsilon=0.001, eval=False, eval_all_timestamps=False, eval_batch_size=512, eval_fix=False, eval_fixed_timesteps=[], eval_next_timestamps=6, eval_stream=False, eval_warmstart_finetune=True, ewc_lambda=1.0, ewc_task_decay=1.0, exp_name='0505_fmow_swa_csaw_last0.25_seed_2', exp_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.25_seed_2', feat_num_components=50, feat_num_samples=100, feat_split='test', feat_threshold=0.1, fisher_n=None, gamma=1.0, group_size=3, irm_lambda=1.0, irm_penalty_anneal_iters=0, last_k_timesteps=0.25, linear_probe=False, linear_probe_iter=None, lisa=False, lisa_intra_domain=False, lisa_start_time=0, load_model=False, log_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', loss_contours=False, lr=0.0001, method='swa', mini_batch_size=64, mix_alpha=2.0, mixup=False, model_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.25_seed_2/checkpoints', momentum=0.9, non_overlapping=False, num_groups=3, num_workers=8, offline_steps=3000, online=False, online_steps=500, online_timesteps=[], prediction_type=None, random_seed=2, reduced_train_prop=None, reduction='mean', regression=False, results_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', sam=False, shuffle_timesteps=False, si_c=0.1, split_time=10, ssl_finetune_iter=0, swa_ewa=True, swa_ewa_lambda=0.5, swa_steps=None, time_conditioned=False, torch_compile=False, train=True, train_update_iter=3000, weight_decay=0.0)
2023-05-05 14:09:52,817 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:09:53,120 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 6 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_1/checkpoints/time_6.pth.

2023-05-05 14:09:53,352 - wildtime.methods.swa.swa - INFO - Training at timestamp 7
2023-05-05 14:13:12,037 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:13:12,327 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 7 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_1/checkpoints/time_7.pth.

2023-05-05 14:13:12,552 - wildtime.methods.swa.swa - INFO - Training at timestamp 8
2023-05-05 14:16:32,679 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:16:32,990 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 8 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_1/checkpoints/time_8.pth.

2023-05-05 14:16:33,234 - wildtime.methods.swa.swa - INFO - Training at timestamp 9
2023-05-05 14:19:55,841 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:19:56,161 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 9 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_1/checkpoints/time_9.pth.

2023-05-05 14:19:56,398 - wildtime.methods.swa.swa - INFO - Training at timestamp 10
2023-05-05 14:22:17,187 - wildtime.methods.swa.swa - INFO - Training at timestamp 8
2023-05-05 14:23:23,737 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:23:24,044 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 10 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_sam_seed_1/checkpoints/time_10.pth.

2023-05-05 14:23:25,055 - wildtime.methods.base_trainer - INFO - 
=================================== Results (Eval-Fix) ===================================
2023-05-05 14:23:25,055 - wildtime.methods.base_trainer - INFO - Metric: accuracy

2023-05-05 14:24:31,847 - wildtime.methods.base_trainer - INFO - ID accuracy: 	0.6179041228922044

2023-05-05 14:24:45,265 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:24:45,656 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 8 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.25_seed_2/checkpoints/time_8.pth.

2023-05-05 14:24:45,927 - wildtime.methods.swa.swa - INFO - Training at timestamp 9
2023-05-05 14:25:16,113 - wildtime.methods.base_trainer - INFO - OOD timestamp = 11: 	 accuracy is 0.6883116883116883
2023-05-05 14:26:17,370 - wildtime.methods.base_trainer - INFO - OOD timestamp = 12: 	 accuracy is 0.6834625322997416
2023-05-05 14:27:18,572 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:27:18,965 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 9 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.25_seed_2/checkpoints/time_9.pth.

2023-05-05 14:27:19,185 - wildtime.methods.swa.swa - INFO - Training at timestamp 10
2023-05-05 14:27:26,960 - wildtime.methods.base_trainer - INFO - OOD timestamp = 13: 	 accuracy is 0.6345588980046591
2023-05-05 14:29:00,667 - wildtime.methods.base_trainer - INFO - OOD timestamp = 14: 	 accuracy is 0.5711510746287362
2023-05-05 14:29:51,345 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:29:51,766 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 10 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.25_seed_2/checkpoints/time_10.pth.

2023-05-05 14:29:52,787 - wildtime.methods.base_trainer - INFO - 
=================================== Results (Eval-Fix) ===================================
2023-05-05 14:29:52,788 - wildtime.methods.base_trainer - INFO - Metric: accuracy

2023-05-05 14:30:00,503 - wildtime.methods.base_trainer - INFO - OOD timestamp = 15: 	 accuracy is 0.46739307204423486
2023-05-05 14:30:00,518 - wildtime.methods.base_trainer - INFO - 
OOD Average Metric: 	0.608975453057812
OOD Worst Metric: 	0.46739307204423486
All OOD Metrics: 	[0.6883116883116883, 0.6834625322997416, 0.6345588980046591, 0.5711510746287362, 0.46739307204423486]

2023-05-05 14:30:10,055 - wildtime.methods.base_trainer - INFO - Runtime: 3788.69

2023-05-05 14:30:35,675 - root - INFO - Namespace(K=1, buffer_size=100, checkpoint_path=None, config_file=None, contour_granularity=5, contour_increment=0.01, contour_margin=0.1, contour_metric='losses', contour_models=None, contour_timesteps=None, coral_lambda=1.0, cut_mix=False, data_dir='/projects/tir6/strubell/data/wilds/data', dataset='fmow', device=0, difficulty=False, emp_FI=False, epsilon=0.001, eval=False, eval_all_timestamps=False, eval_batch_size=512, eval_fix=False, eval_fixed_timesteps=[], eval_next_timestamps=6, eval_stream=False, eval_warmstart_finetune=True, ewc_lambda=1.0, ewc_task_decay=1.0, exp_name='0505_fmow_swa_csaw_last0.1_seed_1', exp_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.1_seed_1', feat_num_components=50, feat_num_samples=100, feat_split='test', feat_threshold=0.1, fisher_n=None, gamma=1.0, group_size=3, irm_lambda=1.0, irm_penalty_anneal_iters=0, last_k_timesteps=0.1, linear_probe=False, linear_probe_iter=None, lisa=False, lisa_intra_domain=False, lisa_start_time=0, load_model=False, log_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', loss_contours=False, lr=0.0001, method='swa', mini_batch_size=64, mix_alpha=2.0, mixup=False, model_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.1_seed_1/checkpoints', momentum=0.9, non_overlapping=False, num_groups=3, num_workers=8, offline_steps=3000, online=False, online_steps=500, online_timesteps=[], prediction_type=None, random_seed=1, reduced_train_prop=None, reduction='mean', regression=False, results_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', sam=False, shuffle_timesteps=False, si_c=0.1, split_time=10, ssl_finetune_iter=0, swa_ewa=True, swa_ewa_lambda=0.5, swa_steps=None, time_conditioned=False, torch_compile=False, train=True, train_update_iter=3000, weight_decay=0.0)
2023-05-05 14:31:01,659 - wildtime.methods.base_trainer - INFO - ID accuracy: 	0.6003354815926547

2023-05-05 14:31:57,745 - wildtime.methods.base_trainer - INFO - OOD timestamp = 11: 	 accuracy is 0.6932467532467532
2023-05-05 14:33:01,219 - wildtime.methods.base_trainer - INFO - OOD timestamp = 12: 	 accuracy is 0.6768410852713178
2023-05-05 14:34:21,469 - wildtime.methods.base_trainer - INFO - OOD timestamp = 13: 	 accuracy is 0.6335460346399271
2023-05-05 14:36:02,154 - wildtime.methods.base_trainer - INFO - OOD timestamp = 14: 	 accuracy is 0.5541074002130459
2023-05-05 14:37:02,254 - wildtime.methods.base_trainer - INFO - OOD timestamp = 15: 	 accuracy is 0.4682062123922589
2023-05-05 14:37:02,256 - wildtime.methods.base_trainer - INFO - 
OOD Average Metric: 	0.6051894971526606
OOD Worst Metric: 	0.4682062123922589
All OOD Metrics: 	[0.6932467532467532, 0.6768410852713178, 0.6335460346399271, 0.5541074002130459, 0.4682062123922589]

2023-05-05 14:37:13,968 - wildtime.methods.base_trainer - INFO - Runtime: 1785.44

2023-05-05 14:37:37,862 - root - INFO - Namespace(K=1, buffer_size=100, checkpoint_path=None, config_file=None, contour_granularity=5, contour_increment=0.01, contour_margin=0.1, contour_metric='losses', contour_models=None, contour_timesteps=None, coral_lambda=1.0, cut_mix=False, data_dir='/projects/tir6/strubell/data/wilds/data', dataset='fmow', device=0, difficulty=False, emp_FI=False, epsilon=0.001, eval=False, eval_all_timestamps=False, eval_batch_size=512, eval_fix=False, eval_fixed_timesteps=[], eval_next_timestamps=6, eval_stream=False, eval_warmstart_finetune=True, ewc_lambda=1.0, ewc_task_decay=1.0, exp_name='0505_fmow_swa_csaw_last0.50_seed_2', exp_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_2', feat_num_components=50, feat_num_samples=100, feat_split='test', feat_threshold=0.1, fisher_n=None, gamma=1.0, group_size=3, irm_lambda=1.0, irm_penalty_anneal_iters=0, last_k_timesteps=0.5, linear_probe=False, linear_probe_iter=None, lisa=False, lisa_intra_domain=False, lisa_start_time=0, load_model=False, log_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', loss_contours=False, lr=0.0001, method='swa', mini_batch_size=64, mix_alpha=2.0, mixup=False, model_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_2/checkpoints', momentum=0.9, non_overlapping=False, num_groups=3, num_workers=8, offline_steps=3000, online=False, online_steps=500, online_timesteps=[], prediction_type=None, random_seed=2, reduced_train_prop=None, reduction='mean', regression=False, results_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', sam=False, shuffle_timesteps=False, si_c=0.1, split_time=10, ssl_finetune_iter=0, swa_ewa=True, swa_ewa_lambda=0.5, swa_steps=None, time_conditioned=False, torch_compile=False, train=True, train_update_iter=3000, weight_decay=0.0)
2023-05-05 14:45:33,809 - wildtime.methods.swa.swa - INFO - Training at timestamp 9
2023-05-05 14:48:00,075 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:48:00,374 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 9 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.1_seed_1/checkpoints/time_9.pth.

2023-05-05 14:48:00,649 - wildtime.methods.swa.swa - INFO - Training at timestamp 10
2023-05-05 14:50:47,562 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:50:47,950 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 10 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.1_seed_1/checkpoints/time_10.pth.

2023-05-05 14:50:48,587 - wildtime.methods.base_trainer - INFO - 
=================================== Results (Eval-Fix) ===================================
2023-05-05 14:50:48,587 - wildtime.methods.base_trainer - INFO - Metric: accuracy

2023-05-05 14:51:53,117 - wildtime.methods.base_trainer - INFO - ID accuracy: 	0.5976869427032754

2023-05-05 14:52:35,268 - wildtime.methods.swa.swa - INFO - Training at timestamp 5
2023-05-05 14:52:37,975 - wildtime.methods.base_trainer - INFO - OOD timestamp = 11: 	 accuracy is 0.6735064935064935
2023-05-05 14:53:33,727 - wildtime.methods.base_trainer - INFO - OOD timestamp = 12: 	 accuracy is 0.6721576227390181
2023-05-05 14:54:38,531 - wildtime.methods.base_trainer - INFO - OOD timestamp = 13: 	 accuracy is 0.6197710928795706
2023-05-05 14:54:54,314 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:54:54,650 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 5 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_2/checkpoints/time_5.pth.

2023-05-05 14:54:54,868 - wildtime.methods.swa.swa - INFO - Training at timestamp 6
2023-05-05 14:56:08,117 - wildtime.methods.base_trainer - INFO - OOD timestamp = 14: 	 accuracy is 0.5526662071558368
2023-05-05 14:57:05,134 - wildtime.methods.base_trainer - INFO - OOD timestamp = 15: 	 accuracy is 0.4657667913481867
2023-05-05 14:57:05,135 - wildtime.methods.base_trainer - INFO - 
OOD Average Metric: 	0.5967736415258211
OOD Worst Metric: 	0.4657667913481867
All OOD Metrics: 	[0.6735064935064935, 0.6721576227390181, 0.6197710928795706, 0.5526662071558368, 0.4657667913481867]

2023-05-05 14:57:14,273 - wildtime.methods.base_trainer - INFO - Runtime: 1598.60

2023-05-05 14:57:15,518 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:57:15,914 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 6 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_2/checkpoints/time_6.pth.

2023-05-05 14:57:16,152 - wildtime.methods.swa.swa - INFO - Training at timestamp 7
2023-05-05 14:57:37,491 - root - INFO - Namespace(K=1, buffer_size=100, checkpoint_path=None, config_file=None, contour_granularity=5, contour_increment=0.01, contour_margin=0.1, contour_metric='losses', contour_models=None, contour_timesteps=None, coral_lambda=1.0, cut_mix=False, data_dir='/projects/tir6/strubell/data/wilds/data', dataset='fmow', device=0, difficulty=False, emp_FI=False, epsilon=0.001, eval=False, eval_all_timestamps=False, eval_batch_size=512, eval_fix=False, eval_fixed_timesteps=[], eval_next_timestamps=6, eval_stream=False, eval_warmstart_finetune=True, ewc_lambda=1.0, ewc_task_decay=1.0, exp_name='0505_fmow_swa_csaw_last0.25_seed_1', exp_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.25_seed_1', feat_num_components=50, feat_num_samples=100, feat_split='test', feat_threshold=0.1, fisher_n=None, gamma=1.0, group_size=3, irm_lambda=1.0, irm_penalty_anneal_iters=0, last_k_timesteps=0.25, linear_probe=False, linear_probe_iter=None, lisa=False, lisa_intra_domain=False, lisa_start_time=0, load_model=False, log_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', loss_contours=False, lr=0.0001, method='swa', mini_batch_size=64, mix_alpha=2.0, mixup=False, model_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.25_seed_1/checkpoints', momentum=0.9, non_overlapping=False, num_groups=3, num_workers=8, offline_steps=3000, online=False, online_steps=500, online_timesteps=[], prediction_type=None, random_seed=1, reduced_train_prop=None, reduction='mean', regression=False, results_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', sam=False, shuffle_timesteps=False, si_c=0.1, split_time=10, ssl_finetune_iter=0, swa_ewa=True, swa_ewa_lambda=0.5, swa_steps=None, time_conditioned=False, torch_compile=False, train=True, train_update_iter=3000, weight_decay=0.0)
2023-05-05 14:59:38,315 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 14:59:38,666 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 7 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_2/checkpoints/time_7.pth.

2023-05-05 14:59:38,879 - wildtime.methods.swa.swa - INFO - Training at timestamp 8
2023-05-05 15:01:57,622 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 15:01:58,000 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 8 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_2/checkpoints/time_8.pth.

2023-05-05 15:01:58,212 - wildtime.methods.swa.swa - INFO - Training at timestamp 9
2023-05-05 15:04:18,437 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 15:04:18,807 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 9 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_2/checkpoints/time_9.pth.

2023-05-05 15:04:19,018 - wildtime.methods.swa.swa - INFO - Training at timestamp 10
2023-05-05 15:06:36,154 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 15:06:36,511 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 10 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_2/checkpoints/time_10.pth.

2023-05-05 15:06:37,305 - wildtime.methods.base_trainer - INFO - 
=================================== Results (Eval-Fix) ===================================
2023-05-05 15:06:37,305 - wildtime.methods.base_trainer - INFO - Metric: accuracy

2023-05-05 15:07:45,053 - wildtime.methods.base_trainer - INFO - ID accuracy: 	0.6056325593714135

2023-05-05 15:08:31,188 - wildtime.methods.base_trainer - INFO - OOD timestamp = 11: 	 accuracy is 0.6971428571428572
2023-05-05 15:09:33,615 - wildtime.methods.base_trainer - INFO - OOD timestamp = 12: 	 accuracy is 0.6753875968992248
2023-05-05 15:10:46,765 - wildtime.methods.base_trainer - INFO - OOD timestamp = 13: 	 accuracy is 0.6297984401904183
2023-05-05 15:11:36,764 - wildtime.methods.swa.swa - INFO - Training at timestamp 8
2023-05-05 15:12:23,990 - wildtime.methods.base_trainer - INFO - OOD timestamp = 14: 	 accuracy is 0.5597468513064728
2023-05-05 15:13:28,571 - wildtime.methods.base_trainer - INFO - OOD timestamp = 15: 	 accuracy is 0.47227191413237923
2023-05-05 15:13:28,594 - wildtime.methods.base_trainer - INFO - 
OOD Average Metric: 	0.6068695319342705
OOD Worst Metric: 	0.47227191413237923
All OOD Metrics: 	[0.6971428571428572, 0.6753875968992248, 0.6297984401904183, 0.5597468513064728, 0.47227191413237923]

2023-05-05 15:13:37,632 - wildtime.methods.base_trainer - INFO - Runtime: 2159.77

2023-05-05 15:13:55,048 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 15:13:55,356 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 8 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.25_seed_1/checkpoints/time_8.pth.

2023-05-05 15:13:55,576 - wildtime.methods.swa.swa - INFO - Training at timestamp 9
2023-05-05 15:16:10,428 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 15:16:10,853 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 9 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.25_seed_1/checkpoints/time_9.pth.

2023-05-05 15:16:11,116 - wildtime.methods.swa.swa - INFO - Training at timestamp 10
2023-05-05 15:18:25,644 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 15:18:26,054 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 10 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.25_seed_1/checkpoints/time_10.pth.

2023-05-05 15:18:26,612 - wildtime.methods.base_trainer - INFO - 
=================================== Results (Eval-Fix) ===================================
2023-05-05 15:18:26,613 - wildtime.methods.base_trainer - INFO - Metric: accuracy

2023-05-05 15:19:30,741 - wildtime.methods.base_trainer - INFO - ID accuracy: 	0.6023660280745122

2023-05-05 15:20:09,072 - wildtime.methods.base_trainer - INFO - OOD timestamp = 11: 	 accuracy is 0.6966233766233766
2023-05-05 15:20:53,085 - wildtime.methods.base_trainer - INFO - OOD timestamp = 12: 	 accuracy is 0.6858850129198967
2023-05-05 15:21:55,934 - wildtime.methods.base_trainer - INFO - OOD timestamp = 13: 	 accuracy is 0.6284817178162666
2023-05-05 15:23:18,801 - wildtime.methods.base_trainer - INFO - OOD timestamp = 14: 	 accuracy is 0.558493639952378
2023-05-05 15:24:12,365 - wildtime.methods.base_trainer - INFO - OOD timestamp = 15: 	 accuracy is 0.47438607903724184
2023-05-05 15:24:12,373 - wildtime.methods.base_trainer - INFO - 
OOD Average Metric: 	0.608773965269832
OOD Worst Metric: 	0.47438607903724184
All OOD Metrics: 	[0.6966233766233766, 0.6858850129198967, 0.6284817178162666, 0.558493639952378, 0.47438607903724184]

2023-05-05 15:24:21,205 - wildtime.methods.base_trainer - INFO - Runtime: 1603.71

2023-05-05 15:24:41,355 - root - INFO - Namespace(K=1, buffer_size=100, checkpoint_path=None, config_file=None, contour_granularity=5, contour_increment=0.01, contour_margin=0.1, contour_metric='losses', contour_models=None, contour_timesteps=None, coral_lambda=1.0, cut_mix=False, data_dir='/projects/tir6/strubell/data/wilds/data', dataset='fmow', device=0, difficulty=False, emp_FI=False, epsilon=0.001, eval=False, eval_all_timestamps=False, eval_batch_size=512, eval_fix=False, eval_fixed_timesteps=[], eval_next_timestamps=6, eval_stream=False, eval_warmstart_finetune=True, ewc_lambda=1.0, ewc_task_decay=1.0, exp_name='0505_fmow_swa_csaw_last0.50_seed_1', exp_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_1', feat_num_components=50, feat_num_samples=100, feat_split='test', feat_threshold=0.1, fisher_n=None, gamma=1.0, group_size=3, irm_lambda=1.0, irm_penalty_anneal_iters=0, last_k_timesteps=0.5, linear_probe=False, linear_probe_iter=None, lisa=False, lisa_intra_domain=False, lisa_start_time=0, load_model=False, log_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', loss_contours=False, lr=0.0001, method='swa', mini_batch_size=64, mix_alpha=2.0, mixup=False, model_path='/projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_1/checkpoints', momentum=0.9, non_overlapping=False, num_groups=3, num_workers=8, offline_steps=3000, online=False, online_steps=500, online_timesteps=[], prediction_type=None, random_seed=1, reduced_train_prop=None, reduction='mean', regression=False, results_dir='/projects/tir6/strubell/jaredfer/projects/wild-time/results', sam=False, shuffle_timesteps=False, si_c=0.1, split_time=10, ssl_finetune_iter=0, swa_ewa=True, swa_ewa_lambda=0.5, swa_steps=None, time_conditioned=False, torch_compile=False, train=True, train_update_iter=3000, weight_decay=0.0)
2023-05-05 15:38:03,626 - wildtime.methods.swa.swa - INFO - Training at timestamp 5
2023-05-05 15:40:09,301 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 15:40:09,642 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 5 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_1/checkpoints/time_5.pth.

2023-05-05 15:40:09,853 - wildtime.methods.swa.swa - INFO - Training at timestamp 6
2023-05-05 15:42:17,361 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 15:42:17,727 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 6 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_1/checkpoints/time_6.pth.

2023-05-05 15:42:17,952 - wildtime.methods.swa.swa - INFO - Training at timestamp 7
2023-05-05 15:44:27,565 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 15:44:27,911 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 7 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_1/checkpoints/time_7.pth.

2023-05-05 15:44:28,123 - wildtime.methods.swa.swa - INFO - Training at timestamp 8
2023-05-05 15:46:42,641 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 15:46:43,023 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 8 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_1/checkpoints/time_8.pth.

2023-05-05 15:46:43,252 - wildtime.methods.swa.swa - INFO - Training at timestamp 9
2023-05-05 15:48:56,587 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 15:48:56,946 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 9 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_1/checkpoints/time_9.pth.

2023-05-05 15:48:57,166 - wildtime.methods.swa.swa - INFO - Training at timestamp 10
2023-05-05 15:51:11,466 - wildtime.methods.swa.swa - INFO - ==== Updating Weights of Averaged Model ====
2023-05-05 15:51:11,818 - wildtime.methods.base_trainer - INFO - Saving model at timestamp 10 to path /projects/tir6/strubell/jaredfer/projects/wild-time/results/0505_fmow_swa_csaw_last0.50_seed_1/checkpoints/time_10.pth.

2023-05-05 15:51:12,443 - wildtime.methods.base_trainer - INFO - 
=================================== Results (Eval-Fix) ===================================
2023-05-05 15:51:12,443 - wildtime.methods.base_trainer - INFO - Metric: accuracy

2023-05-05 15:52:12,395 - wildtime.methods.base_trainer - INFO - ID accuracy: 	0.6068685441864572

2023-05-05 15:52:54,842 - wildtime.methods.base_trainer - INFO - OOD timestamp = 11: 	 accuracy is 0.68
2023-05-05 15:53:47,749 - wildtime.methods.base_trainer - INFO - OOD timestamp = 12: 	 accuracy is 0.6841085271317829
2023-05-05 15:54:49,109 - wildtime.methods.base_trainer - INFO - OOD timestamp = 13: 	 accuracy is 0.6278739997974273
2023-05-05 15:56:12,184 - wildtime.methods.base_trainer - INFO - OOD timestamp = 14: 	 accuracy is 0.5583683188169685
2023-05-05 15:57:05,474 - wildtime.methods.base_trainer - INFO - OOD timestamp = 15: 	 accuracy is 0.47129614571475037
2023-05-05 15:57:05,480 - wildtime.methods.base_trainer - INFO - 
OOD Average Metric: 	0.6043293982921858
OOD Worst Metric: 	0.47129614571475037
All OOD Metrics: 	[0.68, 0.6841085271317829, 0.6278739997974273, 0.5583683188169685, 0.47129614571475037]

2023-05-05 15:57:11,926 - wildtime.methods.base_trainer - INFO - Runtime: 1950.57

